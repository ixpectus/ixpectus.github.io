---
title: "Схемы в базе данных"
date: 2020-07-08T09:35:30+03:00
summary: "Схема в postgresql. Каждая таблица в postgres принадлежит к какой-то схеме, как правило по умолчанию это схема `public`"
tags:
  - postgresql
  - scheme
---
* [Демо](https://edu.postgrespro.ru/dba1/dba1_07_data_databases.pdf)
* [Слайды](https://edu.postgrespro.ru/dba1/dba1_07_data_databases.html)

#### Сравнение с mysql 
В mysql нет схем в понимании postgres, в mysql схема соответствует самой базе данных, а в postgres в одной базе может быть несколько схем.

#### Схема в postgres
Каждая таблица в postgres принадлежит к какой-то схеме, как правило по умолчанию это схема `public`  
* `\dn` так можно посмотреть список схем
* `\dt public.*` так можно посмотреть все таблицы в какой-то одной схеме
##### Как создать схему 
```
create schema test;
```
#### В какой схеме будет происходить поиск таблицы, если она не указана явно
Зависит от значения `search_path`  
* Можно посмотреть так
```
show search_path;
+-----------------+
| search_path     |
|-----------------|
| "$user", public |
+----------------
```
* Или так
```
postgres@127:test> select current_schemas(true);
+--------------------------+
| current_schemas          |
|--------------------------|
| ['pg_catalog', 'public'] |
+-------------------
```
#### Временные таблицы 
* Можно создать временную таблицу, которая будет жить только во время текущего сеанса
```
postgres@127:test> CREATE TEMP TABLE t(s text);
postgres@127:test> select current_schemas(true);
+---------------------------------------+
| current_schemas                       |
|---------------------------------------|
| ['pg_temp_4', 'pg_catalog', 'public'] |
+---------------------------------------+
SELECT 1
```
Понятно, что временная таблица находится в схеме `pg_temp_4` и эта схема стала приоритетной в поиске

 

#### Базы данных и шаблоны 
Посмотреть список баз данных можно 2-мя способами
* `\l`
* `select * from pg_database`  
##### Размер базы банных 
`SELECT pg_size_pretty(pg_database_size('test'));`  




#### Итого
* Кластер баз данных содержит базы данных
* База данных содержит схемы
* Схема содержит таблицы
* Схема либо задаётся явно либо определяется путём поиска

